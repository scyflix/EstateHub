<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EstateHub | Dashboard</title>
    <meta
      name="description"
      content="EstateHub helps you manage, discover, buy, and sell properties with ease. Explore listings, manage properties, and find your perfect home today."
    />
    <meta
      name="keywords"
      content="real estate,manage, property, buy, sell, rent, home, agent, EstateHub"
    />
    <meta name="author" content="EstateHub Team" />
    <link rel="canonical" href="https://www.estatehub.com/home.html" />
    <meta property="og:title" content="EstateHub" />
    <meta
      property="og:description"
      content="Discover, buy, manage and sell properties with EstateHub. Your trusted real estate platform."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.estatehub.com/home.html" />
    <meta
      property="og:image"
      content="https://www.estatehub.com/assets/estatehub-og-image.jpg"
    />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="EstateHub - Find Your Dream Property" />
    <meta
      name="twitter:description"
      content="Explore listings and connect with agents on EstateHub."
    />
    <link rel="stylesheet" href="home.css" />
  </head>
  <body>
    <nav style="display: inline-flex">
      <div class="menu-icon" onclick="toggleSidebar()">
        <span></span>
        <span></span>
        <span></span>
      </div>
      <h1>EstateHub</h1>
    </nav>
    <aside id="sidebar">
      <div id="nav-bar">
        <p style="text-align: center; color: white">Navigate</p>
        <a class="anchor-nav-bar" href="home.html">Dashboard</a>
        <a href="property.html" class="anchor-nav-bar">Add Property</a>
        <a class="anchor-nav-bar" href="Login.html">Login/Signup</a>
      </div>
    </aside>

    <div id="dashboard-content">
      <h2 id="dashboardHeader">Property Count</h2>
      <section id="statsCards">
        <div id="allProperties" class="statsCard">
          <p id="allPropertiesCount">0</p>
        </div>
        <div id="rentedProperty" class="statsCard">
          <h2>Rented</h2>
          <p id="rentedPropertyCount">0</p>
        </div>
        <div id="availableProperty" class="statsCard">
          <h2>Available</h2>
          <p id="availablePropertyCount">0</p>
        </div>
      </section>
      <section id="property-table-section">
        <h3 style="color: white">Property Overview</h3>
        <div id="detailsCard"></div>
      </section>
    </div>

    <footer><p>&copy; EstateHub | All rights reserved</p></footer>
    <script>
      //For side bar display
      const sidebar = document.getElementById("sidebar");
      function toggleSidebar() {
        sidebar.classList.toggle("show");
      }
      //to move between pages if using select element
      function goToLink(selectElement) {
        const selectedValue = selectElement.value;
        if (selectedValue) {
          window.location.href = selectedValue;
        }
      }
      // Link glows slightly when active
      const links = document.querySelectorAll(".anchor-nav-bar");
      links.forEach((link) => {
        if (link.href === window.location.href) {
          link.classList.add("active");
        }
      });

      //Get property details from local storage
      let getproperty = JSON.parse(localStorage.getItem("properties")) || [];

      function renderCards() {
        const detailsCard = document.getElementById("detailsCard");
        let allPropertiesCount = document.getElementById("allPropertiesCount");
        let rentedPropertyCount = document.getElementById(
          "rentedPropertyCount"
        );
        let availablePropertyCount = document.getElementById(
          "availablePropertyCount"
        );
        let allCount = 0;
        let rentedCount = 0;
        let availableCount = 0;
        if (!detailsCard) return; // exit if table not on this page

        if (getproperty.length === 0) {
          detailsCard.innerHTML = `<p>Nothing to show</p>`;
          return;
        }

        detailsCard.innerHTML = "";
        getproperty.forEach((property, index) => {
          allCount++;
          if (property.status.toLowerCase() === "rented") {
            rentedCount++;
          } else {
            availableCount++;
          }
          const cardDiv = document.createElement("div");
          cardDiv.innerHTML = `
          <h3>${property.owner}</h3>
          <p><b>Property Type:</b> ${property.type}</p>
          <p><b>Property Status:</b> ${property.status}</p>
          <p><b>Rent Price:</b> ${property.rent}</p>
          <button onclick="viewProperty(${index})">ðŸ‘€ View</button>
          <button onclick="deleteProperty(${index})">ðŸ—‘ Remove</button>
          `;
          detailsCard.appendChild(cardDiv);
        });
        allPropertiesCount.innerText = allCount;
        rentedPropertyCount.innerText = rentedCount;
        availablePropertyCount.innerText = availableCount;
      }

      function viewProperty(index) {
        const selectedProperty = getproperty[index];
        localStorage.setItem("viewProperty", JSON.stringify(selectedProperty));
        window.location.href = "view-property.html";
      }
      //delet property card
      function deleteProperty(index) {
        if (confirm("Are you sure?")) {
          getproperty.splice(index, 1);
          localStorage.setItem("properties", JSON.stringify(getproperty));
          renderCards();
        }
      }

      document.addEventListener("DOMContentLoaded", renderCards);
    </script>
  </body>
</html>
